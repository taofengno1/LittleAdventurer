<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Little Adventurer</title>
    <style>
        #app {
            text-align: center;
        }

        .toggleSpin {
            margin-top: 20px;
            width: 200px;
            height: 40px;
        }
    </style>
    <script src="https://unpkg.com/vue@next"></script>
</head>

<body>
    <div id="app">
        <wheel></wheel>
    </div>
    <script>
        const Wheel = {
            template: `
                <div class="wheel">
                    <canvas ref="wheelCanvas" :width="size" :height="size"></canvas>
                    <button class="toggleSpin" @click="toggleSpin">{{ spinning ? '停止转动' : '开始转动' }}</button>
                </div>
            `,
            setup() {
                const wheelCanvas = Vue.ref(null);
                const segments = ["写字", "看书", "打牌", "户外活动", "室内运动"];
                let angle = 0;
                let angleIncrement = 0.2;
                let spinning = Vue.ref(false);
                let size = Math.min(window.innerWidth, window.innerHeight) * 0.8; // 设置转盘大小为屏幕较小边的80%

                Vue.onMounted(() => {
                    drawWheel();
                });

                function drawPointer(ctx) {
                    ctx.beginPath();
                    ctx.moveTo(size / 2, 0); // 开始点在顶部中心
                    ctx.lineTo(size / 2 - 10, 20); // 左侧点
                    ctx.lineTo(size / 2 + 10, 20); // 右侧点
                    ctx.closePath();
                    ctx.fillStyle = '#FF0000';
                    ctx.fill();
                    ctx.stroke();
                }

                function drawWheel() {
                    const canvas = wheelCanvas.value;
                    const ctx = canvas.getContext('2d');
                    ctx.clearRect(0, 0, size, size);
                    ctx.save();
                    ctx.translate(size / 2, size / 2);
                    ctx.rotate(angle);

                    const radius = size / 2;
                    const segmentAngle = (2 * Math.PI) / segments.length;

                    for (let i = 0; i < segments.length; i++) {
                        ctx.beginPath();
                        ctx.moveTo(0, 0);
                        ctx.arc(0, 0, radius, segmentAngle * i, segmentAngle * (i + 1));
                        ctx.fillStyle = i % 2 === 0 ? '#1E90FF' : '#FFD700';
                        ctx.fill();
                        ctx.stroke();

                        ctx.fillStyle = '#333';
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'middle';
                        ctx.font = 'bold 16px sans-serif';
                        const textAngle = segmentAngle * (i + 0.5);
                        const textX = (radius * 0.7) * Math.cos(textAngle);
                        const textY = (radius * 0.7) * Math.sin(textAngle);
                        ctx.fillText(segments[i], textX, textY);
                    }

                    ctx.restore();
                    drawPointer(ctx);
                }

                function spinWheel() {
                    if (spinning.value || angleIncrement > 0) {
                        angle += angleIncrement;
                        drawWheel();
                        if (!spinning.value && angleIncrement > 0) {
                            angleIncrement -= 0.002;
                        }
                        requestAnimationFrame(spinWheel);
                    }
                }

                function toggleSpin() {
                    spinning.value = !spinning.value;
                    if (spinning.value) {
                        angleIncrement = 0.2;
                        spinWheel();
                    }
                }

                return { wheelCanvas, spinning, toggleSpin, size };
            }
        };

        const app = Vue.createApp({});
        app.component('wheel', Wheel);
        app.mount('#app');
    </script>
</body>

</html>